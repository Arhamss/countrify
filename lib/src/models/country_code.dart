import 'package:countrify/src/data/all_countries.dart';
import 'package:countrify/src/models/country.dart';

// ignore: camel_case_types
typedef CountryCode = CountryCodeEnum;

/// ISO 3166-1 alpha-2 country codes used by countrify.
enum CountryCodeEnum {
  ad,
  ae,
  af,
  ag,
  al,
  am,
  ao,
  ar,
  at,
  au,
  az,
  ba,
  bb,
  bd,
  be,
  bf,
  bg,
  bh,
  bi,
  bj,
  bn,
  bo,
  br,
  bs,
  bt,
  bw,
  by,
  bz,
  ca,
  cd,
  cf,
  cg,
  ch,
  ci,
  cl,
  cm,
  cn,
  co,
  cr,
  cu,
  cv,
  cy,
  cz,
  de,
  dj,
  dk,
  dm,
  do_,
  dz,
  ec,
  ee,
  eg,
  er,
  es,
  et,
  fi,
  fj,
  fm,
  fr,
  ga,
  gb,
  gd,
  ge,
  gh,
  gm,
  gn,
  gq,
  gr,
  gt,
  gw,
  gy,
  hn,
  hr,
  ht,
  hu,
  id,
  ie,
  il,
  in_,
  iq,
  ir,
  is_,
  it,
  jm,
  jo,
  jp,
  ke,
  kg,
  kh,
  ki,
  km,
  kn,
  kp,
  kr,
  kw,
  kz,
  la,
  lb,
  lc,
  li,
  lk,
  lr,
  ls,
  lt,
  lu,
  lv,
  ly,
  ma,
  mc,
  md,
  me,
  mg,
  mh,
  mk,
  ml,
  mm,
  mn,
  mr,
  mt,
  mu,
  mv,
  mw,
  mx,
  my,
  mz,
  na,
  ne,
  ng,
  ni,
  nl,
  no,
  np,
  nr,
  nz,
  om,
  pa,
  pe,
  pg,
  ph,
  pk,
  pl,
  ps,
  pt,
  pw,
  py,
  qa,
  ro,
  rs,
  ru,
  rw,
  sa,
  sb,
  sc,
  sd,
  se,
  sg,
  si,
  sk,
  sl,
  sm,
  sn,
  so,
  sr,
  ss,
  st,
  sv,
  sy,
  sz,
  td,
  tg,
  th,
  tj,
  tl,
  tm,
  tn,
  to,
  tr,
  tt,
  tv,
  tz,
  ua,
  ug,
  us,
  uy,
  uz,
  va,
  vc,
  ve,
  vn,
  vu,
  ws,
  ye,
  za,
  zm,
  zw,
}

extension CountryCodeExtension on CountryCodeEnum {
  /// Parses an ISO 3166-1 alpha-2 code and returns a [CountryCodeEnum].
  ///
  /// Returns null when no matching enum value exists.
  static CountryCodeEnum? fromAlpha2Code(String alpha2Code) {
    final normalized = alpha2Code.trim().toLowerCase();
    if (normalized.isEmpty) return null;

    final enumName = switch (normalized) {
      'do' => 'do_',
      'in' => 'in_',
      'is' => 'is_',
      _ => normalized,
    };

    for (final value in CountryCode.values) {
      if (value.name == enumName) return value;
    }
    return null;
  }

  /// Returns the ISO 3166-1 alpha-2 code.
  String get alpha2Code {
    final normalized =
        name.endsWith('_') ? name.substring(0, name.length - 1) : name;
    return normalized.toUpperCase();
  }

  /// Resolves this code to the matching [Country], if present in the dataset.
  Country? get country => AllCountries.getByAlpha2Code(alpha2Code);
}
